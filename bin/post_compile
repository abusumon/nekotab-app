# filepath: d:\Sumon\Coding\nekotab-app\bin\post_compile
#!/usr/bin/env bash

set -eo pipefail

echo "-----> I'm post-compile hook"

# Temporarily disable strict Redis SSL verification during build
export INSECURE_REDIS=1

echo "-----> Running database migration"
python ./tabbycat/manage.py migrate --noinput

echo "-----> Running dynamic preferences checks"
python ./tabbycat/manage.py checkpreferences

echo "-----> Running static files compilation"
python ./tabbycat/manage.py collectstatic --noinput -v 0

echo "-----> Post-compile done"