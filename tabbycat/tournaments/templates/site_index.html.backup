{% extends "base.html" %}
{% load i18n static %}

{% block head-title %}<span class="emoji">üëã</span> {% trans "Welcome!" %}{% endblock %}
{% block page-title %}Home{% endblock %}

{% block page-alerts %}
  {% include 'errors/database_limit_warning.html' %}
  {% include 'errors/legacy_sendgrid_warning.html' %}
{% endblock %}

{% block content %}

{% if not user.is_authenticated %}
  <!-- Hero Section: World-Class Professional Design -->
  <section id="hero" class="position-relative d-flex align-items-center" style="min-height: 100vh; background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #667eea 100%); overflow: hidden;">
    <!-- Animated Particles Background -->
    <div class="position-absolute w-100 h-100" style="top: 0; left: 0;">
      <div class="particles-bg" style="position: absolute; width: 100%; height: 100%; background-image: 
        radial-gradient(circle at 10% 20%, rgba(255,255,255,0.08) 0%, transparent 50%),
        radial-gradient(circle at 90% 80%, rgba(255,255,255,0.08) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(255,255,255,0.05) 0%, transparent 50%);
        background-size: 100% 100%;
        animation: float 20s ease-in-out infinite;">
      </div>
    </div>
    
    <div class="container position-relative" style="z-index: 10; padding: 4rem 1.5rem;">
      <div class="row align-items-center">
        <div class="col-lg-7 col-md-12 mb-5 mb-lg-0">
          <!-- Logo & Brand -->
          <div class="mb-5 d-flex align-items-center animate-fade-in">
            <img src="{% static 'branding/logo.png' %}" alt="NekoTab" style="width: 90px; height: 90px; margin-right: 1.2rem; filter: drop-shadow(0 6px 18px rgba(0,0,0,0.35));">
            <div>
              <h2 class="text-white font-weight-bold mb-0" style="font-size: 3.25rem; letter-spacing: -0.02em; line-height: 1;">NekoTab</h2>
              <p class="text-white mb-0" style="opacity: 0.9; font-size: 1.05rem; margin-top: 0.4rem;">{% trans "Professional Tournament Platform" %}</p>
            </div>
          </div>
          
          <!-- Main Heading -->
          <h1 class="font-weight-bold text-white mb-4 animate-slide-up" style="font-size: clamp(2.8rem, 6vw, 5rem); line-height: 1.1; letter-spacing: -0.03em;">
            {% trans "Host World-Class" %}<br>
            <span style="background: linear-gradient(120deg, #fbbf24 0%, #f59e0b 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-fill-color: transparent;">{% trans "Debate Tournaments" %}</span>
          </h1>
          
          <!-- Subheading -->
          <p class="lead text-white mb-5 animate-slide-up" style="font-size: clamp(1.15rem, 2.5vw, 1.45rem); line-height: 1.7; opacity: 0.95; max-width: 600px; font-weight: 400;">
            {% trans "The most reliable tournament management system in Bangladesh. Built for debaters, by debaters. Just ‡ß≥2500 per tournament." %}
          </p>

          <!-- CTA Buttons -->
          <div class="d-flex flex-column flex-sm-row align-items-start animate-slide-up" style="gap: 1.2rem; margin-bottom: 3rem;">
            <a href="{% url 'signup' %}" class="btn btn-warning btn-lg px-5 py-3 shadow-lg" style="background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); border: none; border-radius: 50px; font-weight: 700; font-size: 1.15rem; color: #1e3a8a; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 10px 40px rgba(251, 191, 36, 0.4);">
              {% trans "Get Started Free" %} ‚Üí
            </a>

            <a href="{% url 'login' %}" class="btn btn-outline-light btn-lg px-5 py-3" style="border-radius: 50px; font-weight: 600; font-size: 1.15rem; border-width: 2px; transition: all 0.3s ease; backdrop-filter: blur(10px); background: rgba(255,255,255,0.1);">
              {% trans "Log In" %}
            </a>
          </div>

          <!-- Trust Stats -->
          <div class="d-flex flex-wrap animate-fade-in" style="gap: 3rem; padding-top: 2rem; border-top: 2px solid rgba(255,255,255,0.2);">
            <div>
              <div class="h1 font-weight-bold mb-1" style="color: #fbbf24; text-shadow: 0 2px 10px rgba(251,191,36,0.3);" data-target="120">0</div>
              <div class="text-white" style="opacity: 0.9; font-size: 1.05rem; font-weight: 500;">{% trans "Active Debaters" %}</div>
            </div>
            <div>
              <div class="h1 font-weight-bold mb-1" style="color: #fbbf24; text-shadow: 0 2px 10px rgba(251,191,36,0.3);" data-target="10">0</div>
              <div class="text-white" style="opacity: 0.9; font-size: 1.05rem; font-weight: 500;">{% trans "Tournaments" %}</div>
            </div>
            <div>
              <div class="h1 font-weight-bold mb-1" style="color: #fbbf24; text-shadow: 0 2px 10px rgba(251,191,36,0.3);">99.9<span style="font-size: 0.7em;">%</span></div>
              <div class="text-white" style="opacity: 0.9; font-size: 1.05rem; font-weight: 500;">{% trans "Uptime" %}</div>
            </div>
          </div>
        </div>

        <div class="col-lg-5 col-md-12 position-relative d-none d-lg-block animate-scale-in">
          <!-- Modern Dashboard Preview -->
          <div class="position-relative" style="perspective: 1200px;">
            <div style="transform: rotateY(-5deg) rotateX(5deg); transition: transform 0.6s ease;">
              <div class="card border-0" style="border-radius: 28px; overflow: hidden; background: white; box-shadow: 0 30px 90px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.1);">
                <div style="background: linear-gradient(135deg, #f1f5f9 0%, #e0e7ff 100%); padding: 2.5rem;">
                  <div style="height: 360px; background: linear-gradient(135deg, #dbeafe 0%, #ffffff 100%); border-radius: 24px; display: flex; align-items: center; justify-content: center; color: #1e40af; font-weight: 700; font-size: 1.3rem; box-shadow: 0 25px 70px rgba(30,64,175,0.15); position: relative; overflow: hidden;">
                    <div class="position-absolute w-100 h-100" style="background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.4) 50%, transparent 70%); animation: shimmer 4s infinite;"></div>
                    <div class="text-center">
                      <div style="font-size: 3rem; margin-bottom: 1rem;">üìä</div>
                      {% trans "Live Dashboard" %}
                    </div>
                  </div>
                  <div class="d-flex mt-4" style="gap: 1.2rem;">
                    <div style="flex: 1.5; height: 16px; background: linear-gradient(90deg, #3b82f6, #93c5fd); border-radius: 12px; box-shadow: 0 2px 8px rgba(59,130,246,0.3);"></div>
                    <div style="flex: 1.5; height: 14px; background: linear-gradient(90deg, #60a5fa, #93c5fd); border-radius: 10px;"></div>
                    <div style="flex: 0.8; height: 14px; background: linear-gradient(90deg, #a78bfa, #ddd6fe); border-radius: 10px;"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </section>

  <!-- Events Showcase Section -->
  <section class="py-5" style="background: #ffffff; position: relative; overflow: hidden;">
    <div class="container py-5">
      <div class="text-center mb-5">
        <h2 class="display-4 font-weight-bold mb-3" style="color: #1e293b;">{% trans "Events" %}</h2>
        <p class="lead text-muted" style="max-width: 600px; margin: 0 auto;">
          {% trans "Where NekoTab has powered debate tournaments across the country" %}
        </p>
      </div>

      <!-- Infinite Auto-Scroll Slider (Right-to-Left) -->
      <div class="events-slider-container" style="position: relative; padding: 2rem 0; overflow: hidden;">
        <div class="events-slider" style="display: flex; gap: 2rem; animation: scroll-left 35s linear infinite; will-change: transform;">
          <!-- Placeholder Event Cards - Replace with your actual event images -->
          <div class="event-card" style="min-width: 380px; height: 280px; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.1); position: relative; flex-shrink: 0;">
            <img src="{% static 'branding/logo.png' %}" alt="Event 1" style="width: 100%; height: 100%; object-fit: cover;">
            <div class="event-overlay" style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 2rem 1.5rem; color: white;">
              <h5 class="font-weight-bold mb-1">{% trans "National Debate Championship 2024" %}</h5>
              <p class="mb-0 small" style="opacity: 0.9;">{% trans "120+ participants" %}</p>
            </div>
          </div>

          <div class="event-card" style="min-width: 380px; height: 280px; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.1); position: relative; flex-shrink: 0;">
            <img src="{% static 'branding/logo.png' %}" alt="Event 2" style="width: 100%; height: 100%; object-fit: cover;">
            <div class="event-overlay" style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 2rem 1.5rem; color: white;">
              <h5 class="font-weight-bold mb-1">{% trans "Inter-University Debate 2024" %}</h5>
              <p class="mb-0 small" style="opacity: 0.9;">{% trans "85+ participants" %}</p>
            </div>
          </div>

          <div class="event-card" style="min-width: 380px; height: 280px; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.1); position: relative; flex-shrink: 0;">
            <img src="{% static 'branding/logo.png' %}" alt="Event 3" style="width: 100%; height: 100%; object-fit: cover;">
            <div class="event-overlay" style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 2rem 1.5rem; color: white;">
              <h5 class="font-weight-bold mb-1">{% trans "Regional Debate Cup 2024" %}</h5>
              <p class="mb-0 small" style="opacity: 0.9;">{% trans "60+ participants" %}</p>
            </div>
          </div>

          <!-- Duplicate for seamless loop -->
          <div class="event-card" style="min-width: 380px; height: 280px; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.1); position: relative; flex-shrink: 0;">
            <img src="{% static 'branding/logo.png' %}" alt="Event 1" style="width: 100%; height: 100%; object-fit: cover;">
            <div class="event-overlay" style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 2rem 1.5rem; color: white;">
              <h5 class="font-weight-bold mb-1">{% trans "National Debate Championship 2024" %}</h5>
              <p class="mb-0 small" style="opacity: 0.9;">{% trans "120+ participants" %}</p>
            </div>
          </div>

          <div class="event-card" style="min-width: 380px; height: 280px; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.1); position: relative; flex-shrink: 0;">
            <img src="{% static 'branding/logo.png' %}" alt="Event 2" style="width: 100%; height: 100%; object-fit: cover;">
            <div class="event-overlay" style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 2rem 1.5rem; color: white;">
              <h5 class="font-weight-bold mb-1">{% trans "Inter-University Debate 2024" %}</h5>
              <p class="mb-0 small" style="opacity: 0.9;">{% trans "85+ participants" %}</p>
            </div>
          </div>
          <!-- Optional third duplicate for longer loops -->
          <div class="event-card" style="min-width: 380px; height: 280px; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.1); position: relative; flex-shrink: 0;">
            <img src="{% static 'branding/logo.png' %}" alt="Event 3" style="width: 100%; height: 100%; object-fit: cover;">
            <div class="event-overlay" style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); padding: 2rem 1.5rem; color: white;">
              <h5 class="font-weight-bold mb-1">{% trans "Regional Debate Cup 2024" %}</h5>
              <p class="mb-0 small" style="opacity: 0.9;">{% trans "60+ participants" %}</p>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>

  <!-- Global Styles -->
  <style>
    /* Animations */
    @keyframes scroll-left {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    @keyframes fade-in {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slide-up {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes scale-in {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    .animate-fade-in { animation: fade-in 1s ease-out; }
    .animate-slide-up { animation: slide-up 0.8s ease-out; animation-fill-mode: both; }
    .animate-slide-up:nth-child(2) { animation-delay: 0.2s; }
    .animate-slide-up:nth-child(3) { animation-delay: 0.3s; }
    .animate-slide-up:nth-child(4) { animation-delay: 0.4s; }
    .animate-scale-in { animation: scale-in 1s ease-out 0.3s both; }

    /* Events Slider */
    .events-slider-container:hover .events-slider {
      animation-play-state: paused;
    }

    .event-card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .event-card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 20px 60px rgba(0,0,0,0.2) !important;
    }

    /* Button Hover Effects */
    .btn-light:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 15px 40px rgba(0,0,0,0.2) !important;
    }

    .btn-outline-light:hover {
      background: rgba(255,255,255,0.15);
      border-color: white;
      transform: translateY(-2px);
    }

    /* 3D Dashboard Hover */
    .dashboard-preview:hover {
      transform: rotateY(-5deg) rotateX(5deg);
    }

    .shadow-2xl {
      box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25) !important;
    }

    /* Mobile Optimizations */
    @media (max-width: 768px) {
      .event-card {
        min-width: 300px;
        height: 240px;
      }
      
      .events-slider { animation-duration: 40s; }
    }
  </style>

  <script>
    // Counter Animation
    (function(){
      function animateCounters(){
        document.querySelectorAll('[data-target]').forEach(function(el){
          var target = parseFloat(el.getAttribute('data-target')) || 0;
          var duration = 2000;
          var start = 0;
          var startTime = null;
          
          function step(timestamp){
            if(!startTime) startTime = timestamp;
            var progress = Math.min((timestamp - startTime) / duration, 1);
            var easeOutQuart = 1 - Math.pow(1 - progress, 4);
            var value = start + (target - start) * easeOutQuart;
            el.textContent = Math.floor(value);
            if(progress < 1) window.requestAnimationFrame(step);
          }
          window.requestAnimationFrame(step);
        });
      }
      
      if(document.readyState === 'complete') {
        animateCounters();
      } else {
        window.addEventListener('load', animateCounters);
      }
    })();
  </script>
  </section>

  <!-- Features Section -->
  <section class="py-5" style="background: linear-gradient(180deg, #f8fafc 0%, #ffffff 100%);">
    <div class="container py-5">
      <div class="text-center mb-5">
        <h2 class="display-4 font-weight-bold mb-3" style="color: #1e293b;">
          {% trans "Why Choose NekoTab?" %}
        </h2>
        <p class="lead text-muted" style="max-width: 650px; margin: 0 auto;">
          {% trans "Built for speed, fairness, and simplicity ‚Äî everything you need for world-class tournaments." %}
        </p>
      </div>

      <div class="row">
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="feature-card h-100 p-5 text-center" style="background: white; border-radius: 24px; box-shadow: 0 10px 40px rgba(0,0,0,0.06); transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); border: 2px solid transparent;">
            <div class="mb-4 d-inline-flex align-items-center justify-content-center" style="width: 80px; height: 80px; border-radius: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);">
              <span style="font-size: 40px;">‚öôÔ∏è</span>
            </div>
            <h4 class="font-weight-bold mb-3" style="color: #1e293b;">{% trans "Smart Tab Engine" %}</h4>
            <p class="text-muted mb-0" style="line-height: 1.8; font-size: 1.05rem;">
              {% trans "Built on the trusted Tabbycat core, with custom automation for faster pairing and instant tab releases." %}
            </p>
          </div>
        </div>

        <div class="col-lg-4 col-md-6 mb-4">
          <div class="feature-card h-100 p-5 text-center" style="background: white; border-radius: 24px; box-shadow: 0 10px 40px rgba(0,0,0,0.06); transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); border: 2px solid transparent;">
            <div class="mb-4 d-inline-flex align-items-center justify-content-center" style="width: 80px; height: 80px; border-radius: 20px; background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%); box-shadow: 0 10px 30px rgba(245, 158, 11, 0.3);">
              <span style="font-size: 40px;">üí≥</span>
            </div>
            <h4 class="font-weight-bold mb-3" style="color: #1e293b;">{% trans "Transparent Pricing" %}</h4>
            <p class="text-muted mb-0" style="line-height: 1.8; font-size: 1.05rem;">
              {% trans "Flat ‡ß≥2500 per tournament, no hidden costs. Pay securely through bKash with instant confirmation." %}
            </p>
          </div>
        </div>

        <div class="col-lg-4 col-md-6 mb-4">
          <div class="feature-card h-100 p-5 text-center" style="background: white; border-radius: 24px; box-shadow: 0 10px 40px rgba(0,0,0,0.06); transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); border: 2px solid transparent;">
            <div class="mb-4 d-inline-flex align-items-center justify-content-center" style="width: 80px; height: 80px; border-radius: 20px; background: linear-gradient(135deg, #10b981 0%, #34d399 100%); box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);">
              <span style="font-size: 40px;">üì±</span>
            </div>
            <h4 class="font-weight-bold mb-3" style="color: #1e293b;">{% trans "Works Anywhere" %}</h4>
            <p class="text-muted mb-0" style="line-height: 1.8; font-size: 1.05rem;">
              {% trans "Optimized for desktop, tablet, and mobile ‚Äî perfect for tab rooms and on-the-go judges." %}
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <style>
    .feature-card:hover {
      transform: translateY(-12px);
      box-shadow: 0 20px 60px rgba(0,0,0,0.15) !important;
      border-color: #667eea !important;
    }
  </style>

{% else %}
  <!-- Authenticated User Dashboard: only show tournaments the user arranged -->
  {% if tournaments %}
    <div class="mb-4">
      <h2 class="mb-3">{% trans "Your Tournaments" %}</h2>
      {% for tournament in tournaments %}
        {% include "tournament_index_links.html" %}
      {% endfor %}
    </div>
  {% else %}
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-body text-center py-5">
        <div class="mb-3" style="color: #667eea;">
          <i data-feather="calendar" style="width: 64px; height: 64px;"></i>
        </div>
        <h3 class="mb-3">{% trans "No Tournaments Yet" %}</h3>
        <p class="text-muted mb-4">{% trans "Get started by creating your first tournament." %}</p>
        <a href="{% url 'tournament-create' %}" class="btn btn-primary btn-lg">
          <i data-feather="plus-circle" style="width: 18px; height: 18px;"></i>
          {% trans "Create Tournament" %}
        </a>
      </div>
    </div>
  {% endif %}

  {% if inactive %}
    <div class="mb-4">
      <h3 class="mb-3 text-muted">{% trans "Inactive Tournaments" %}</h3>
      <div class="list-group">
        {% trans '(inactive)' as inactive_subtext %}
        {% for tournament in inactive %}
          {% include "tournament_index_links.html" with type="dark" subtext=inactive_subtext %}
        {% endfor %}
      </div>
    </div>
  {% endif %}
{% endif %}

<div class="list-group mt-2">
  {% if user.is_superuser %}

    {% trans "New Tournament" as text %}{% url 'tournament-create' as url %}
    {% include "components/item-action.html" with icon="plus-circle" %}

    {% trans "Edit Database Area" as text %}{% url 'admin:index' as url %}
    {% include "components/item-action.html" with icon="edit" %}

    {% trans "Send a Test Email" as text %}{% url 'notifications-test-email' as url %}
    {% include "components/item-action.html" with icon="send" %}

    {% trans "Import DebateXML" as text %}{% url 'importer-archive' as url %}
    {% include "components/item-action.html" with icon="archive" %}

  {% endif %}
</div>

<div class="list-group mt-2">
  {% if user.is_authenticated %}

    {% blocktrans asvar text %}Get API Token / Change Password ({{ user }}){% endblocktrans %}
    {% url 'password_change' as url %}
    {% include "components/item-action.html" with icon="rotate-cw" %}

    <form id="logout-link-form" method="post" action="{% url 'logout' %}" class="list-group-item list-group-item-action text-primary">
      {% csrf_token %}
      <button type="submit" class="btn btn-link p-0 list-group-item-action text-primary">
        <div class="row align-items-center">
          <div class="col-auto pr-1">
            <i data-feather="log-out"></i>
          </div>

          <div class="col pl-0 pr-0">
            {% blocktrans %}Log Out ({{ user }}){% endblocktrans %}
          </div>

          <div class="col-auto pr-1">
            <i data-feather="chevron-right"></i>
          </div>
        </div>
      </button>
    </form>

  {% endif %}
</div>

{% endblock content %}
