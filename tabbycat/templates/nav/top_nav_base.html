{% load debate_tags static i18n %}

<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm" style="padding: 1rem 0;">
  <div class="container">

  {# Decisions about whether to show items in the menu are based on the role of the user (not the view). #}
  {% blocktrans trimmed asvar logo_alt %}
    NekoTab Logo
  {% endblocktrans %}
  {% if all_tournaments.count > 1 or user.is_authenticated %}
    <div class="nav-item dropdown">

      <button class="btn btn-link mr-2 p-0 navbar-brand dropdown-toggle" id="tournamentdrop"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="font-weight: 700; font-size: 1.25rem; color: #1e293b; text-decoration: none;">
        {% if on_local %}
          {% include "nav/logo_local.html" with width=36 height=36 alt=logo_alt %}
        {% else %}
          {% include "nav/logo.html" with width=36 height=36 alt=logo_alt %}
        {% endif %}
        {% if tournament %}{{ tournament }}{% else %}NekoTab{% endif %}
      </button>

      <div class="dropdown-menu" aria-labelledby="tournamentdrop">

        {% for tournament in all_tournaments %}

          {% if user.is_superuser %}
            <a class="dropdown-item px-2" href="{% url 'tournament-admin-home' tournament_slug=tournament.slug %}">
              <i data-feather="settings"></i>
              {% blocktrans trimmed %}
                Administrator area for <strong>{{ tournament }}</strong>
              {% endblocktrans %}
            </a>
          {% endif %}

          {% if user.is_authenticated %}
            <a class="dropdown-item px-2" href="{% url 'tournament-assistant-home' tournament_slug=tournament.slug %}">
              <i data-feather="pocket"></i>
              {% blocktrans trimmed %}
                Assistant area for <strong>{{ tournament }}</strong>
              {% endblocktrans %}
            </a>
          {% endif %}

          <a class="dropdown-item px-2" href="{% url 'tournament-public-index' tournament_slug=tournament.slug %}">
            {% if user.is_authenticated %}
              <i data-feather="globe"></i>
              {% blocktrans trimmed %}
                Public area for <strong>{{ tournament }}</strong>
              {% endblocktrans %}
            {% else %}
              <i data-feather="award"></i>
              {{ tournament }}
            {% endif %}
          </a>

          <div class="dropdown-divider"></div>
        {% endfor %}

        {% if user.is_staff %}
          <a href="{% url 'admin:index' %}" target="_blank" class="dropdown-item px-2">
            <i data-feather="database"></i>{% translate "Edit Database" %}
          </a>
          <div class="dropdown-divider"></div>
        {% endif %}

        <a class="dropdown-item px-2" href="/"><i data-feather="home"></i>{% trans "Site Home" %}</a>
      </div>

    </div>
  {% else %}
    <div class="nav-item">

      {% if tournament %}
        <a class="navbar-brand d-flex align-items-center" href="{{ tournament.get_public_url  }}" style="font-weight: 700; font-size: 1.25rem; color: #1e293b; text-decoration: none;">
          {% include "nav/logo.html" with width=36 height=36  alt=logo_alt %}
          <span class="ml-2">{{ tournament }}</span>
        </a>
      {% else %}
        <a class="navbar-brand d-flex align-items-center" href="/" style="font-weight: 700; font-size: 1.25rem; color: #1e293b; text-decoration: none;">
          {% include "nav/logo.html" with width=36 height=36 alt=logo_alt %}
          <span class="ml-2">NekoTab</span>
        </a>
      {% endif %}

    </div>
  {% endif %}

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsed-main-nav" aria-controls="collapsed-main-nav" aria-expanded="false" aria-label="Toggle navigation" style="border: 1px solid #e2e8f0; padding: 0.5rem;">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse pt-3 pt-md-0 pb-2 pb-md-0" id="collapsed-main-nav">

    <ul class="navbar-nav mr-auto">

      {% if user_role == "assistant" %}
        {% include "nav/assistant_nav.html" %}
      {% else %}
        {% include "nav/public_nav.html" %}
      {% endif %}

    </ul>

    <ul class="navbar-nav ml-auto align-items-lg-center">
      {% if user.is_authenticated %}
        <li class="nav-item">
          <form id="logout-form" action="{% url 'logout' %}" method="post">
            {% csrf_token %}
            <button type="submit" class="btn btn-link nav-link" style="color: #64748b; font-weight: 500;">
              {% trans "Log Out" %} ({{ user }})
            </button>
          </form>
        </li>
      {% else %}
        <li class="nav-item mr-2 mb-2 mb-lg-0">
          <a class="btn btn-outline-primary" href="{% url 'login' %}" style="padding: 0.6rem 1.5rem; font-weight: 600; border-radius: 8px; border-width: 2px;">
            {% trans "Log In" %}
          </a>
        </li>
        <li class="nav-item mb-2 mb-lg-0">
          <a class="btn btn-primary" href="{% url 'signup' %}" style="padding: 0.6rem 1.5rem; font-weight: 600; border-radius: 8px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">
            {% trans "Sign Up" %}
          </a>
        </li>
      {% endif %}
    </ul>

  </div>

  </div>
</nav>
